{
    "info": {
        "_postman_id": "qshelter-property-service-v1",
        "name": "QShelter Property Service",
        "description": "Property service endpoints: create property, variants, units, link payment methods.",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
        {
            "key": "propertyServiceUrl",
            "value": "http://localhost:3003",
            "type": "string"
        },
        {
            "key": "tenantId",
            "value": "",
            "type": "string"
        },
        {
            "key": "adminAccessToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "propertyId",
            "value": "",
            "type": "string"
        },
        {
            "key": "variantId",
            "value": "",
            "type": "string"
        },
        {
            "key": "unitId",
            "value": "",
            "type": "string"
        }
    ],
    "item": [
        {
            "name": "1 - Create Property (Lekki Gardens Estate)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    },
                    {
                        "key": "Authorization",
                        "value": "Bearer {{adminAccessToken}}"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"title\": \"Lekki Gardens Estate\",\n  \"category\": \"SALE\",\n  \"propertyType\": \"APARTMENT\",\n  \"country\": \"Nigeria\",\n  \"currency\": \"NGN\",\n  \"city\": \"Lagos\",\n  \"district\": \"Lekki\",\n  \"status\": \"PUBLISHED\",\n  \"isPublished\": true\n}"
                },
                "url": {
                    "raw": "{{propertyServiceUrl}}/properties",
                    "host": [
                        "{{propertyServiceUrl}}"
                    ],
                    "path": [
                        "properties"
                    ]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "const res = pm.response.json();",
                            "if (res.success && res.data) {",
                            "  pm.collectionVariables.set('propertyId', res.data.id);",
                            "  pm.test('Property created', () => { pm.expect(res.data.id).to.be.a('string'); });",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "2 - Create Variant (3-Bedroom Flat)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    },
                    {
                        "key": "Authorization",
                        "value": "Bearer {{adminAccessToken}}"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"name\": \"3-Bedroom Flat\",\n  \"nBedrooms\": 3,\n  \"nBathrooms\": 3,\n  \"nParkingSpots\": 1,\n  \"area\": 150,\n  \"price\": 85000000,\n  \"totalUnits\": 20,\n  \"availableUnits\": 15,\n  \"status\": \"AVAILABLE\"\n}"
                },
                "url": {
                    "raw": "{{propertyServiceUrl}}/properties/{{propertyId}}/variants",
                    "host": [
                        "{{propertyServiceUrl}}"
                    ],
                    "path": [
                        "properties",
                        "{{propertyId}}",
                        "variants"
                    ]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "const res = pm.response.json();",
                            "if (res.success && res.data) {",
                            "  pm.collectionVariables.set('variantId', res.data.id);",
                            "  pm.test('Variant created', () => { pm.expect(res.data.id).to.be.a('string'); });",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "3 - Create Unit (14B)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    },
                    {
                        "key": "Authorization",
                        "value": "Bearer {{adminAccessToken}}"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"unitNumber\": \"14B\",\n  \"floorNumber\": 14,\n  \"blockName\": \"Block B\",\n  \"status\": \"AVAILABLE\"\n}"
                },
                "url": {
                    "raw": "{{propertyServiceUrl}}/variants/{{variantId}}/units",
                    "host": [
                        "{{propertyServiceUrl}}"
                    ],
                    "path": [
                        "variants",
                        "{{variantId}}",
                        "units"
                    ]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "const res = pm.response.json();",
                            "if (res.success && res.data) {",
                            "  pm.collectionVariables.set('unitId', res.data.id);",
                            "  pm.test('Unit created', () => { pm.expect(res.data.id).to.be.a('string'); });",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "4 - Get Property",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "Authorization",
                        "value": "Bearer {{adminAccessToken}}"
                    }
                ],
                "url": {
                    "raw": "{{propertyServiceUrl}}/properties/{{propertyId}}",
                    "host": [
                        "{{propertyServiceUrl}}"
                    ],
                    "path": [
                        "properties",
                        "{{propertyId}}"
                    ]
                }
            }
        },
        {
            "name": "5 - List Properties",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "Authorization",
                        "value": "Bearer {{adminAccessToken}}"
                    }
                ],
                "url": {
                    "raw": "{{propertyServiceUrl}}/properties",
                    "host": [
                        "{{propertyServiceUrl}}"
                    ],
                    "path": [
                        "properties"
                    ]
                }
            }
        }
    ]
}